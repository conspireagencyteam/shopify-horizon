{%- doc -%}
  Renders block content for all blocks that extend the group block.
  Custom version that supports individual border widths for top, bottom, left, and right.

  @param {string} children - The DOM content of the group block.
  @param {object} list_items - An array of HTML for the list items to display in the carousel
  @param {object} settings - The settings of the group block.
  @param {string} shopify_attributes - String with Shopify attributes for the editor.

  @example
  {% render '1-list', children: children, list_items: list_items, settings: block.settings, shopify_attributes: block.shopify_attributes %}
{%- enddoc -%}

{% liquid
  case settings.layout_type
    when 'grid'
      assign classes = 'resource-list--grid'
    when 'carousel'
      assign classes = 'resource-list__carousel'
  endcase

  capture styles
    echo '--resource-list-column-gap: ' | append: settings.columns_gap | append: 'px;'
    echo '--resource-list-column-gap-desktop: ' | append: settings.columns_gap | append: 'px;'
    
    if settings.layout_type == 'grid'
      echo '--resource-list-row-gap: ' | append: settings.rows_gap | append: 'px;'
      echo '--resource-list-row-gap-desktop: ' | append: settings.rows_gap | append: 'px;'
      echo '--resource-list-columns-per-row: ' | append: settings.columns | append: ';'
      echo '--resource-list-columns: repeat(' | append: settings.columns | append: ', 1fr);'
    endif
    
    if settings.layout_type == 'carousel'
      echo '--column-count: ' | append: settings.columns | append: ';'
    endif
    
    if settings.layout_type_mobile == 'grid'
      echo '--resource-list-columns-mobile: repeat(' | append: settings.mobile_columns | append: ', 1fr);'
    endif
  endcapture
%}

<div
  class="
    group-block
    spacing-style
    color-{{ settings.color_scheme }}
    block-resource-list
  "
  style="
    --column-count-mobile: {{ settings.mobile_columns }};
    {% render 'spacing-style', settings: settings %}
    {% render 'gap-style', value: settings.gap %}
    {{ styles }}
  "
  {{ shopify_attributes }}
>
  {% if children != blank %}
    <div class="block-resource-list__header">
      {{ children }}
    </div>
  {% endif %}

  {% liquid
    # Create an array from the list items to be used for different layout types
    assign list_items_array = list_items | strip | split: '<!--@list/split-->'
  %}
  

  <div
    class="
      block-resource-list
      {% if settings.layout_type == 'carousel' %}
        force-full-width
      {% endif %}
      {% if settings.layout_type_mobile != settings.layout_type or settings.layout_type != 'grid' and settings.layout_type_mobile != 'grid' and settings.columns != settings.mobile_columns %}
        hidden--mobile
      {% endif %}
      {{ classes }}
    "
    style="
      {{ styles }}
    "
    {% if settings.layout_type == 'grid' %}
      data-testid="resource-list-grid"
    {% endif %}
  >
    {% case settings.layout_type %}
      {% when 'grid' %}
        {{ list_items }}
      {% when 'carousel' %}
        {% liquid        
          assign slide_count = list_items_array.size | plus: 1 | minus: settings.columns
        %}
        {% render '1-list-carousel',
          ref: 'resourceListCarousel',
          slides: list_items_array,
          slide_count: slide_count,
          settings: settings
        %}
    {% endcase %}
  </div>

  {% if settings.layout_type_mobile != settings.layout_type or settings.layout_type != 'grid' and settings.layout_type_mobile != 'grid' and settings.columns != settings.mobile_columns %}
    {% case settings.layout_type_mobile %}
      {% when 'carousel' %}
        {% liquid
          assign mobile_carousel_gap = settings.columns_gap
        %}
        <div
          class="
            resource-list
            hidden--desktop
            force-full-width
          "
          style="
            --resource-list-column-gap-desktop: {{ mobile_carousel_gap }}px;
            --column-count: {{ settings.columns }};
          "
        >
          {% liquid        
            assign slide_count = list_items_array.size | plus: 1 | minus: settings.mobile_columns
          %}
          {% render '1-list-carousel',
            ref: 'resourceListCarouselMobile',
            slides: list_items_array,
            slide_count: slide_count,
            settings: settings
          %}
        </div>
      {% when 'grid' %}
        <div
          class="
            resource-list
            hidden--desktop
            resource-list--grid
          "
          style="
            --resource-list-column-gap-desktop: {{ settings.columns_gap }}px;
            --resource-list-row-gap-desktop: {{ settings.rows_gap }}px;
            --resource-list-columns: repeat({{ settings.columns }}, 1fr);
            --resource-list-columns-mobile: repeat({{ settings.mobile_columns }}, 1fr);
          "
        >
          {{ list_items }}
        </div>
    {% endcase %}
  {% endif %}
</div>